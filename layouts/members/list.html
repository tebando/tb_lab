{{ define "main" }}

{{ $memberPages := .RegularPages }}
{{ $staff := (where $memberPages "Params.member_group" "staff").ByWeight }}
{{ $phd := (where $memberPages "Params.member_group" "phd").ByWeight }}
{{ $master := (where $memberPages "Params.member_group" "master").ByWeight }}
{{ $researchStudent := (where $memberPages "Params.member_group" "research_student").ByWeight }}
{{ $collaborator := (where $memberPages "Params.member_group" "collaborator").ByWeight }}
{{ $alumni := (where $memberPages "Params.member_group" "alumni").ByWeight }}
{{ $isEn := eq site.Language.Lang "en" }}
{{ $staffTitle := cond $isEn "Staff" "スタッフ" }}
{{ $phdTitle := cond $isEn "Doctoral Students" "博士学生" }}
{{ $masterTitle := cond $isEn "Master's Students" "修士学生" }}
{{ $researchStudentTitle := cond $isEn "Doctoral Research Students" "博士研究生" }}
{{ $collaboratorTitle := cond $isEn "Collaborators" "共同研究者" }}
{{ $nameLabel := cond $isEn "Name" "氏名" }}
{{ $positionLabel := cond $isEn "Position" "職位" }}
{{ $gradeLabel := cond $isEn "Year" "学年" }}
{{ $enrollmentYearLabel := cond $isEn "Enrollment Year" "在籍年" }}
{{ $affiliationLabel := cond $isEn "Affiliation" "所属" }}
{{ $themeKeywordLabel := cond $isEn "Research Themes (Keywords)" "研究テーマ（キーワード）" }}
{{ $graduationYearLabel := cond $isEn "Graduation Year" "修了年度" }}

<section class="section">
  <div class="container members-page">
    {{ if .Content }}
    <div class="row">
      <div class="col-12">
        <div class="content members-intro">
          {{ .Content }}
        </div>
      </div>
    </div>
    {{ end }}

    <section class="members-section">
      <h2 class="members-section-title">{{ $staffTitle }}</h2>
      {{ if gt (len $staff) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table members-table-4col">
          <thead>
            <tr>
              <th>{{ $nameLabel }}</th>
              <th>{{ $positionLabel }}</th>
              <th>{{ $affiliationLabel }}</th>
              <th>{{ $themeKeywordLabel }}</th>
            </tr>
          </thead>
          <tbody>
            {{ range $staff }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ .Params.role | default "-" }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">{{ $phdTitle }}</h2>
      {{ if gt (len $phd) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table members-table-4col">
          <thead>
            <tr>
              <th>{{ $nameLabel }}</th>
              <th>{{ $gradeLabel }}</th>
              <th>{{ $affiliationLabel }}</th>
              <th>{{ $themeKeywordLabel }}</th>
            </tr>
          </thead>
          <tbody>
            {{ range $phd }}
            {{ $grade := trim (partial "grade.html" .) " \n\t" }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ $grade }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">{{ $masterTitle }}</h2>
      {{ if gt (len $master) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table members-table-4col">
          <thead>
            <tr>
              <th>{{ $nameLabel }}</th>
              <th>{{ $gradeLabel }}</th>
              <th>{{ $affiliationLabel }}</th>
              <th>{{ $themeKeywordLabel }}</th>
            </tr>
          </thead>
          <tbody>
            {{ range $master }}
            {{ $grade := trim (partial "grade.html" .) " \n\t" }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ $grade }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">{{ $researchStudentTitle }}</h2>
      {{ if gt (len $researchStudent) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table members-table-4col">
          <thead>
            <tr>
              <th>{{ $nameLabel }}</th>
              <th>{{ $enrollmentYearLabel }}</th>
              <th>{{ $affiliationLabel }}</th>
              <th>{{ $themeKeywordLabel }}</th>
            </tr>
          </thead>
          <tbody>
            {{ range $researchStudent }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ .Params.enrolled_year | default "-" }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">{{ $collaboratorTitle }}</h2>
      {{ if gt (len $collaborator) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table members-table-4col">
          <thead>
            <tr>
              <th>{{ $nameLabel }}</th>
              <th>{{ $positionLabel }}</th>
              <th>{{ $affiliationLabel }}</th>
              <th>{{ $themeKeywordLabel }}</th>
            </tr>
          </thead>
          <tbody>
            {{ range $collaborator }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ .Params.role | default "-" }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">Alumni</h2>
      {{ if gt (len $alumni) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table members-table-3col">
          <thead>
            <tr>
              <th>{{ $nameLabel }}</th>
              <th>{{ $graduationYearLabel }}</th>
              <th>{{ $themeKeywordLabel }}</th>
            </tr>
          </thead>
          <tbody>
            {{ range $alumni }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ .Params.graduation_year | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>
  </div>
</section>

{{ end }}
