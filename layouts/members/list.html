{{ define "main" }}

{{ $memberPages := .RegularPages }}
{{ $staff := (where $memberPages "Params.member_group" "staff").ByWeight }}
{{ $phd := (where $memberPages "Params.member_group" "phd").ByWeight }}
{{ $master := (where $memberPages "Params.member_group" "master").ByWeight }}
{{ $researchStudent := (where $memberPages "Params.member_group" "research_student").ByWeight }}
{{ $collaborator := (where $memberPages "Params.member_group" "collaborator").ByWeight }}
{{ $alumni := (where $memberPages "Params.member_group" "alumni").ByWeight }}

<section class="section">
  <div class="container members-page">
    {{ if .Content }}
    <div class="row">
      <div class="col-12">
        <div class="content members-intro">
          {{ .Content }}
        </div>
      </div>
    </div>
    {{ end }}

    <section class="members-section">
      <h2 class="members-section-title">スタッフ</h2>
      {{ if gt (len $staff) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table">
          <thead>
            <tr>
              <th>氏名</th>
              <th>職位</th>
              <th>所属</th>
              <th>研究テーマ（キーワード）</th>
            </tr>
          </thead>
          <tbody>
            {{ range $staff }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ .Params.role | default "-" }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">博士学生</h2>
      {{ if gt (len $phd) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table">
          <thead>
            <tr>
              <th>氏名</th>
              <th>学年</th>
              <th>所属</th>
              <th>研究テーマ（キーワード）</th>
            </tr>
          </thead>
          <tbody>
            {{ range $phd }}
            {{ $grade := trim (partial "grade.html" .) " \n\t" }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ if $grade }}{{ $grade }}{{ else }}{{ .Params.note | default "-" }}{{ end }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">修士学生</h2>
      {{ if gt (len $master) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table">
          <thead>
            <tr>
              <th>氏名</th>
              <th>学年</th>
              <th>所属</th>
              <th>研究テーマ（キーワード）</th>
            </tr>
          </thead>
          <tbody>
            {{ range $master }}
            {{ $grade := trim (partial "grade.html" .) " \n\t" }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ if $grade }}{{ $grade }}{{ else }}{{ .Params.note | default "-" }}{{ end }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">博士研究生</h2>
      {{ if gt (len $researchStudent) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table">
          <thead>
            <tr>
              <th>氏名</th>
              <th>学年 / 注記</th>
              <th>所属</th>
              <th>研究テーマ（キーワード）</th>
            </tr>
          </thead>
          <tbody>
            {{ range $researchStudent }}
            {{ $grade := trim (partial "grade.html" .) " \n\t" }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ if $grade }}{{ $grade }}{{ else }}{{ .Params.note | default "-" }}{{ end }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else if .Params.note }}{{ .Params.note }}{{ else }}-{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">共同研究者</h2>
      {{ if gt (len $collaborator) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table">
          <thead>
            <tr>
              <th>氏名</th>
              <th>職位</th>
              <th>所属</th>
              <th>研究テーマ（キーワード）</th>
            </tr>
          </thead>
          <tbody>
            {{ range $collaborator }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ .Params.role | default "-" }}</td>
              <td>{{ .Params.affiliation | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}{{ .Params.note | default "-" }}{{ end }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>

    <section class="members-section">
      <h2 class="members-section-title">Alumni</h2>
      {{ if gt (len $alumni) 0 }}
      <div class="table-responsive members-table-wrap">
        <table class="table members-table">
          <thead>
            <tr>
              <th>氏名</th>
              <th>修了年</th>
              <th>学位</th>
              <th>研究テーマ（任意）</th>
              <th>進路（任意）</th>
            </tr>
          </thead>
          <tbody>
            {{ range $alumni }}
            <tr>
              <td>{{ partial "member_link.html" . }}</td>
              <td>{{ .Params.graduation_year | default "-" }}</td>
              <td>{{ .Params.degree | default "-" }}</td>
              <td>{{ if .Params.keywords }}{{ delimit .Params.keywords ", " }}{{ else }}-{{ end }}</td>
              <td>{{ .Params.career | default "-" }}</td>
            </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      {{ end }}
    </section>
  </div>
</section>

{{ end }}
